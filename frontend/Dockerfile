FROM node:16-alpine
#ROM node:18.1.0-alpine3.14

#RUN mkdir /onb
WORKDIR /onb

ARG NEXT_PUBLIC_AUTH_TOKEN
ARG NEXT_PUBLIC_ENDPOINT_BASE_URL
ARG NEXT_PUBLIC_KEY
ARG NEXT_PUBLIC_APIM_KEY
ARG NEXT_PUBLIC_BUGSNAG_KEY

ENV NEXT_PUBLIC_AUTH_TOKEN $NEXT_PUBLIC_AUTH_TOKEN
ENV NEXT_PUBLIC_ENDPOINT_BASE_URL $NEXT_PUBLIC_ENDPOINT_BASE_URL
ENV NEXT_PUBLIC_KEY $NEXT_PUBLIC_KEY
ENV NEXT_PUBLIC_APIM_KEY $NEXT_PUBLIC_APIM_KEY
ENV NEXT_PUBLIC_BUGSNAG_KEY $NEXT_PUBLIC_BUGSNAG_KEY

#COPY package*.json ./onb/

COPY . /onb/
#COPY package*.json ./onb/

COPY package.json /onb
COPY package-lock.json /onb

RUN npm install

RUN npm run build

#EXPOSE 8081

EXPOSE 3000

#ENTRYPOINT ["npm", "start"]

CMD ["npm", "start"]